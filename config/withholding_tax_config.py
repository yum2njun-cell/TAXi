"""
TAXi - 원천세 시스템 설정 정보
기존 원천세 시스템의 설정을 TAXi 구조에 맞게 통합
"""

# 회사별 설정 구조화
COMPANY_CONFIGS = {
    1: {  # 애커튼 파트너스
        'name': '애커튼 파트너스',
        'mappings': [
            ('급여(종로)', 4, '급여'),
            ('사이닝보너스', 5, '사이닝보너스'),
            ('중도퇴사', 7, '중도퇴사'),
            ('일용근로', 8, '일용근로'),
            ('퇴직소득 과세이연', 15, 'A22'),
            ('국내원천소득', 27, '법인원천'),
            ('이자소득', 25, '이자소득'),
            ('배당소득', 26, '배당소득'),
            ('사업소득', 19, 'A30'),
            ('기타소득', 24, 'A40'),
            ('연말정산(합계)', 9, 'A04'),
            ('연말정산(분납액)', 10, 'A05'),
            ('연말정산(1월퇴사)', 11, 'A06'),
            ('연말정산(납부액)', 12, 'A07')
        ],
        'extract_func': 'company1',
        'groups': {
            'salary': ['급여(종로)', '사이닝보너스', '중도퇴사', '일용근로'],
            'retirement': ['퇴직소득 과세', '퇴직소득 과세이연'],
            'yearend': ['연말정산(합계)', '연말정산(분납액)', '연말정산(1월퇴사)', '연말정산(납부액)'],
            'other': ['국내원천소득', '이자소득', '배당소득', '사업소득', '기타소득']
        }
    },
    2: {  # SK INC
        'name': 'SK INC',
        'mappings': [
            ('급여(INC 본점)', 17, '급여_본점'),
            ('급여(이천)', 18, '급여_이천'),
            ('일용근로소득', 19, '일용근로'),
            ('중도퇴사연말정산(INC 본점)', 21, '중도퇴사_본점'),
            ('중도퇴사연말정산(이천)', 22, '중도퇴사_이천'),
            ('연말정산납부금액', 24, '연말정산납부'),
            ('연말정산분납금액', 25, '연말정산납부'),
            ('연말정산이천', 26, '연말정산이천'),
            ('퇴직소득 과세', 29, '퇴직_과세'),
            ('퇴직소득 과세이연', 30, '퇴직_과세이연'),
            ('배당소득', 32, '배당소득'),
            ('기타소득', 33, '기타소득'),
            ('법인원천소득', 34, '법인원천'),
            ('사업소득', 35, '사업소득'),
        ],
        'extract_func': 'company2',
        'groups': {
            'salary': ['급여(INC 본점)', '급여(이천)', '일용근로소득'],
            'mid_resignation': ['중도퇴사연말정산(INC 본점)', '중도퇴사연말정산(이천)'],
            'yearend': ['연말정산납부금액', '연말정산이천'],
            'retirement': ['퇴직소득 과세', '퇴직소득 과세이연'],
            'other': ['배당소득', '기타소득', '법인원천소득', '사업소득']
        }
    },
    3: {  # SK MRCIC
        'name': 'SK MRCIC',
        'mappings': [
            ('급여(MR 본점)', 8, '급여_MR본점'),
            ('급여(세종)', 9, '급여_세종'),
            ('급여(영주)', 10, '급여_영주'),
            ('급여(동탄)', 11, '급여_동탄'),
            ('급여(상주)', 12, '급여_상주'),
            ('일용근로소득', 26, '일용근로'),
            ('중도퇴사연말정산(MR 본점)', 28, '중도퇴사_MR본점'),
            ('중도퇴사연말정산(세종)', 29, '중도퇴사_세종'),
            ('중도퇴사연말정산(영주)', 30, '중도퇴사_영주'),
            ('중도퇴사연말정산(동탄)', 31, '중도퇴사_동탄'),
            ('연말정산(MR 본점)', 39, '연말정산_MR본점'),
            ('연말정산(세종)', 40, '연말정산_세종'),
            ('연말정산(영주)', 41, '연말정산_영주'),
            ('연말정산(동탄)', 42, '연말정산_동탄'),
            ('연말정산(상주)', 43, '연말정산_상주'),
            ('퇴직소득 과세', 46, '퇴직_과세'),
            ('퇴직소득 과세이연(MR 본점)', 47, '퇴직_과세이연_MR본점'),
            ('퇴직소득 과세이연(세종)', 48, '퇴직_과세이연_세종'),
            ('법인원천소득', 54, '법인원천'),
            ('배당소득', 52, '배당소득'),
            ('기타소득', 53, '기타소득'),
            ('사업소득', 55, '사업소득'),
        ],
        'extract_func': 'company3',
        'groups': {
            'salary': ['급여(MR 본점)', '급여(세종)', '급여(영주)', '급여(동탄)', '급여(상주)', '일용근로소득'],
            'mid_resignation': ['중도퇴사연말정산(MR 본점)', '중도퇴사연말정산(세종)', '중도퇴사연말정산(영주)', '중도퇴사연말정산(동탄)', '중도퇴사연말정산(상주)'],
            'yearend': ['연말정산(MR 본점)', '연말정산(세종)', '연말정산(영주)', '연말정산(동탄)', '연말정산(상주)'],
            'retirement': ['퇴직소득 과세', '퇴직소득 과세이연(MR 본점)', '퇴직소득 과세이연(세종)'],
            'other': ['법인원천소득', '배당소득', '이자소득', '기타소득', '사업소득']
        },
        'zero_items': ['중도퇴사연말정산(상주)', '이자소득']
    },
    4: {  # SK AX
        'name': 'SK AX',
        'sheets': {
            '원천세신고내역(표)': ['급여(분당)', '급여(충무로)', '급여(대덕)'],
            '아르바이트': ['일용직(3개월이상)', '일용근로소득'],
            '근로소득': ['중도퇴사연말정산(분당)'],
            '세액': ['우리사주(분당)'],
            '퇴직소득': ['퇴직소득 과세', '퇴직소득 과세이연'],
            '기타&사업소득원장': ['국내원천소득', '기타소득', '사업소득'],
            '배당소득': ['배당소득'],
            '연말정산': ['연말정산(분당)', '연말정산(충무로)', '연말정산(대덕)']
        },
        'groups': {
            'salary': ['급여(분당)', '급여(충무로)', '급여(대덕)', '일용직(3개월이상)', '일용근로소득'],
            'mid_resignation': ['중도퇴사연말정산(분당)'],
            'employee_stock': ['우리사주(분당)'],
            'yearend': ['연말정산(분당)', '연말정산(충무로)', '연말정산(대덕)'],
            'retirement': ['퇴직소득 과세', '퇴직소득 과세이연'],
            'other': ['국내원천소득', '배당소득', '기타소득', '사업소득']
        }
    }
}

# 사업장별 설정
WORKPLACE_CONFIGS = {
    'SK_INC': {
        'INC본점': {
            '근로소득': ['급여(INC 본점)', '일용근로소득', '중도퇴사연말정산(INC 본점)'],
            '퇴직소득': ['퇴직소득 과세'],
            '기타소득': ['기타소득'],
            '사업소득': ['사업소득'],
            '국내원천소득': ['법인원천소득'],
            '배당소득': ['배당소득'],
            '연말정산': ['연말정산납부금액', '연말정산분납금액']
        },
        '이천': {
            '근로소득': ['급여(이천)', '중도퇴사연말정산(이천)'],
            '연말정산': ['연말정산이천']
        }
    },
    'SK_AX': {
        '분당': {
            '근로소득': ['급여(분당)', '일용직(3개월이상)', '일용근로소득', '중도퇴사연말정산(분당)', '우리사주(분당)'],
            '퇴직소득': ['퇴직소득 과세', '퇴직소득 과세이연'],
            '기타소득': ['기타소득'],
            '사업소득': ['사업소득'],
            '국내원천소득': ['국내원천소득'],
            '배당소득': ['배당소득'],
            '연말정산': ['연말정산(분당)']
        },
        '충무로': {
            '근로소득': ['급여(충무로)'],
            '연말정산': ['연말정산(충무로)']
        },
        '대덕': {
            '근로소득': ['급여(대덕)'],
            '연말정산': ['연말정산(대덕)']
        }
    },
    'SK_MRCIC': {
        'MR본점': {
            '배당소득': ['배당소득'],
            '사업소득': ['사업소득'],
            '근로소득': ['급여(MR 본점)', '일용근로소득', '중도퇴사연말정산(MR 본점)'],
            '기타소득': ['기타소득'],
            '퇴직소득': ['퇴직소득 과세'],
            '국내원천소득': ['법인원천소득'],
            '연말정산': ['연말정산(MR 본점)']
        },
        '세종': {
            '근로소득': ['급여(세종)', '중도퇴사연말정산(세종)'],
            '연말정산': ['연말정산(세종)']
        },
        '영주': {
            '근로소득': [],
            '연말정산': []
        },
        '동탄': {
            '근로소득': ['급여(동탄)', '중도퇴사연말정산(동탄)'],
            '연말정산': ['연말정산(동탄)']
        },
        '상주': {
            '근로소득': ['급여(상주)', '중도퇴사연말정산(상주)'],
            '연말정산': ['연말정산(상주)']
        }
    },
    'ACKERTURN': {
        '애커튼': {
            '배당소득': ['배당소득'],
            '사업소득': ['사업소득'],
            '근로소득': ['급여(종로)', '사이닝보너스', '중도퇴사', '일용근로'],
            '기타소득': ['기타소득'],
            '퇴직소득': ['퇴직소득 과세'],
            '국내원천소득': ['국내원천소득'],
            '연말정산': ['연말정산(합계)']
        }
    }
}

# 통합 사업장 순서 정의
WORKPLACE_ORDER = ['INC본점', '이천', '분당', '충무로', '대덕', 'MR본점', '세종', '영주', '동탄', '상주', '애커튼']

# 소득 유형 정의
INCOME_TYPES = ['배당소득', '사업소득', '근로소득', '기타소득', '퇴직소득', '국내원천소득', '연말정산', '전체계']

# 데이터 필드 정의
DATA_FIELDS = ['인원', '과세소득', '제출비과세', '총지급액', '소득세', '주민세']

# 홈택스 신고 항목 순서
HOMETAX_ITEMS = [
    '간이세액',
    '중도퇴사', 
    '일용근로소득',
    '가감계1',
    '퇴직소득과세이연',
    '퇴직소득과세',
    '가감계2',
    '사업소득',
    '기타소득',
    '법인원천',
    '배당소득',
    '연말정산',
    '이자소득',
    '총합계',
    '농특세',
    '총합계2',
    '전월미환급세액',
    '최종납부할세액'
]

# 엑셀 컬럼 매핑
EXCEL_COLUMNS = {
    '인원': 'B',
    '과세소득': 'C', 
    '제출비과세': 'D',
    '총지급액': 'E',
    '소득세': 'F',
    '주민세': 'G'
}

# 파일 유형별 설정
FILE_TYPES = {
    'excel': {
        'extensions': ['.xlsx', '.xls'],
        'max_size_mb': 100,
        'description': 'Excel 원천세 데이터 파일'
    },
    'pdf': {
        'extensions': ['.pdf'],
        'max_size_mb': 50,
        'description': 'PDF 원천세 신고서 파일'
    }
}

# 처리 설정
PROCESSING_SETTINGS = {
    'temp_file_retention_hours': 1,
    'max_concurrent_files': 10,
    'enable_data_validation': True,
    'enable_backup': True,
    'log_level': 'INFO'
}

# 유효성 검증 규칙
VALIDATION_RULES = {
    'personnel_range': (0, 10000),  # 인원수 범위
    'tax_amount_range': (0, 999999999),  # 세액 범위
    'income_amount_range': (0, 9999999999),  # 소득 범위
    'required_fields': ['인원', '소득세', '주민세'],
    'optional_fields': ['과세소득', '제출비과세', '총지급액']
}

# 오류 메시지
ERROR_MESSAGES = {
    'file_not_found': '파일을 찾을 수 없습니다.',
    'invalid_file_type': '지원하지 않는 파일 형식입니다.',
    'file_too_large': '파일 크기가 제한을 초과했습니다.',
    'sheet_not_found': '지정된 시트를 찾을 수 없습니다.',
    'data_validation_failed': '데이터 유효성 검증에 실패했습니다.',
    'processing_failed': '데이터 처리 중 오류가 발생했습니다.',
    'excel_generation_failed': 'Excel 파일 생성에 실패했습니다.',
    'company_detection_failed': '파일명에서 회사를 인식할 수 없습니다.'
}

# 성공 메시지
SUCCESS_MESSAGES = {
    'file_uploaded': '파일 업로드가 완료되었습니다.',
    'processing_completed': '데이터 처리가 완료되었습니다.',
    'excel_generated': 'Excel 파일이 생성되었습니다.',
    'data_validated': '데이터 유효성 검증이 완료되었습니다.',
    'backup_created': '백업 파일이 생성되었습니다.'
}

# 경고 메시지
WARNING_MESSAGES = {
    'data_integrity_warning': '데이터 무결성 경고가 있습니다.',
    'missing_personnel': '인원수가 누락된 항목이 있습니다.',
    'negative_values': '음수 값이 발견되었습니다.',
    'inconsistent_data': '일관성이 없는 데이터가 있습니다.'
}

# 로그 설정
LOG_FILENAME = 'data_errors.log'
LOG_FORMAT = '%(asctime)s - %(levelname)s - %(message)s'

# 디버그 모드 설정
DEBUG_MODE = False
VERBOSE_LOGGING = False
